---
titel: mod 998244353でのFPS(Formal Power Series, 形式的べき級数)
documentation_of: //formal-power-series/fps998.hpp
---

mod998244353での処理に特化したFPSの諸々を実装しています。
→いつか998以外のNTT-friendly素数について拡張して、任意mod畳み込みも実装したいね～
Nyaan's Libraryをメチャメチャ参考にしました。

## inv系

### 計算量
下の3つのどれも、FPSのサイズ(最大次数+1)を $N$ として
- $O(N \log N)$

### inv_fast2
これが最速のはず。
Library Checkerでは500msほど。


### inv_fast1
逆元を(体数倍の分だけ)速めに求める
Library Checkerでは650msほど。
→もういらないかも

### inv_naive
逆元を(定数倍の分だけ)遅めに求める
Library Checkerでは920msほど。

## log
logを求める。定数項が`1`でないことを要求する。

### 計算量
$O(N \log N)$

## exp
expを求める。定数項が`0`であることを要求する。
~~現在はバグっている！~~ → 治りました`

### 計算量

- $O(N \log N)$

## 多項式の除算と余り

`%`や`/`が演算子オーバーロードにより実装されているので、それを使う。

### 計算量
$f$の次数を$N$,$g$の次数を$M$として $f/g$の商と余りを、
- $O((N+M)\log(N+M) + M\log M)$
で求められる。